<html>
  <head>
    <title>forum</title>
    <link rel="stylesheet" href="assets/css/home.css">
  </head>
  <body>
    <div class="top-bar">
      <div class="left-images">
    <img src="assets/img/logoforum.png" alt="Image gauche">
  </div>
      <div class="middle-buttons">
        <form>
          <select name="filters" id="filters">
            <option>select filter</option>
            <option>your messages</option>
            <option>liked posts</option>
          </select>
          <select name="categories" id="categories">
            <option value="">select categories</option>
            <option>categorie 1</option>
            <option>categorie 2</option>
            <option>categorie 3</option>
          </select>
        </form>
      </div>
      <div class="right-buttons">
        <div class="right-buttons">
          {{if .IsLoggedIn}} 
              <form action="/logout" method="POST">
                <button type="submit" class="btn">Logout</button>
              </form>
              <!--<button href="/logout" type="submit" class="btn">Logout</button>-->
          {{else}}
          <!-- Popup de login -->
          <!--<input type="checkbox" id="login-popup" hidden>-->
          <input type="checkbox" id="login-popup" hidden {{with .Error}}checked{{end}}>

          <label for="login-popup" class="btn">Login</label>        

          <div class="popup">
            <div class="popup-content" id="login-popup">
              <label for="login-popup" class="close">&times;</label>
              <h2>Connexion</h2>
              <form action="/login" method="POST">
                {{with .Error}}
                  <p style="color:red; font-weight:bold;">{{.}}</p>
                {{end}}
                <input type="email" name="email" placeholder="email" value="{{.Email}}" required>
                <input type="password" name="password" placeholder="password" required>
                  
                <button type="submit">Se connecter</button>
              </form>
            </div>
          </div>    
          {{end}}    
          <a href="/register" class="btn">Register</a>        
        </div>
            </div>
          </div>
          {{if .IsLoggedIn}} 
              <div class="mainpart">
              <button id="new-subject-btn" class="btn">+ New Subject</button>
          </div>
        <div id="subject-form" class="form-container" style="display: none;">
            <form method="POST" action="/create-topic">
                <input type="text" name="title" placeholder="Object of subject" required>
                <textarea name="content" placeholder="Topic content" required></textarea>
                <button type="submit" class="btn">Publish</button>
            </form>
        </div>
        {{end}}

<h2>Latest topics</h2>

<div class="topics-header">
    <span class="header-title">Object</span>
    <span class="header-content">Content</span>
</div>

{{range .Topics}}
<div class="topic-banner">
    <a href="/topic?id={{.ID}}">
        <span class="topic-title">{{.Title}}</span>
        <span class="topic-content">
            {{if gt (len .Content) 80}}
                {{slice .Content 0 80}}...
            {{else}}
                {{.Content}}
            {{end}}
        </span>
    </a>
</div>
{{else}}
<p>Aucun sujet pour le moment.</p>
{{end}}


  </body>
  <script>
    document.getElementById("new-subject-btn").addEventListener("click", () => {
        document.getElementById("subject-form").style.display = "block";
    });

    </script>
  </body>
</html>
